<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>cds: cds::lock::SpinT&lt; ATOMIC, BACKOFF &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.2 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Data&#160;Fields</span></a></li>
    </ul>
  </div>
  <div class="navpath">
    <ul>
      <li><a class="el" href="namespacecds.html">cds</a>      </li>
      <li><a class="el" href="namespacecds_1_1lock.html">lock</a>      </li>
      <li><a class="el" href="classcds_1_1lock_1_1_spin_t.html">SpinT</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a>  </div>
  <div class="headertitle">
<h1>cds::lock::SpinT&lt; ATOMIC, BACKOFF &gt; Class Template Reference</h1>  </div>
</div>
<div class="contents">
<!-- doxytag: class="cds::lock::SpinT" -->
<p>Spin lock.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;spinlock.h&gt;</code></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afba308eb4b0277a4728cddf1edf75071"></a><!-- doxytag: member="cds::lock::SpinT::atomic_type" ref="afba308eb4b0277a4728cddf1edf75071" args="" -->
typedef ATOMIC&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcds_1_1lock_1_1_spin_t.html#afba308eb4b0277a4728cddf1edf75071">atomic_type</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">atomic type <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1a1de06c99d5d333bb19c0cd782bb948"></a><!-- doxytag: member="cds::lock::SpinT::backoff_strategy" ref="a1a1de06c99d5d333bb19c0cd782bb948" args="" -->
typedef BACKOFF&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcds_1_1lock_1_1_spin_t.html#a1a1de06c99d5d333bb19c0cd782bb948">backoff_strategy</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">backoff strategy type <br/></td></tr>
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae0698b7b555f2f5d7aedcf0bf9019f93"></a><!-- doxytag: member="cds::lock::SpinT::SpinT" ref="ae0698b7b555f2f5d7aedcf0bf9019f93" args="()" -->
CDS_CONSTEXPR&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcds_1_1lock_1_1_spin_t.html#ae0698b7b555f2f5d7aedcf0bf9019f93">SpinT</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct free (unlocked) spin-lock. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcds_1_1lock_1_1_spin_t.html#a53fe77645228546b02cc55e93d4419da">SpinT</a> (bool bLocked)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct spin-lock in specified state.  <a href="#a53fe77645228546b02cc55e93d4419da"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcds_1_1lock_1_1_spin_t.html#a6fd7e177006283461fc815f5949eba8d">SpinT</a> (const <a class="el" href="classcds_1_1lock_1_1_spin_t.html">SpinT</a>&lt; ATOMIC, BACKOFF &gt; &amp;)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Dummy copy constructor.  <a href="#a6fd7e177006283461fc815f5949eba8d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8975dac3f82a21543b21268a56e3d73a"></a><!-- doxytag: member="cds::lock::SpinT::~SpinT" ref="a8975dac3f82a21543b21268a56e3d73a" args="()" -->
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcds_1_1lock_1_1_spin_t.html#a8975dac3f82a21543b21268a56e3d73a">~SpinT</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor. On debug time it checks whether spin-lock is free. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2acf6d0c79223c576ef41f897da7d906"></a><!-- doxytag: member="cds::lock::SpinT::tryLock" ref="a2acf6d0c79223c576ef41f897da7d906" args="()" -->
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcds_1_1lock_1_1_spin_t.html#a2acf6d0c79223c576ef41f897da7d906">tryLock</a> ()  throw ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Try to lock the object. Return <code>true</code> if success. Debug version: deadlock may be detected. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a87d6d57bf9a64734e6188cdacc9eef8a"></a><!-- doxytag: member="cds::lock::SpinT::tryLock" ref="a87d6d57bf9a64734e6188cdacc9eef8a" args="(unsigned int nTryCount)" -->
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcds_1_1lock_1_1_spin_t.html#a87d6d57bf9a64734e6188cdacc9eef8a">tryLock</a> (unsigned int nTryCount)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Try to lock the object, repeat <code>nTryCount</code> times if failed. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abc51a4dd8dde922cc93c90af91b628e4"></a><!-- doxytag: member="cds::lock::SpinT::lock" ref="abc51a4dd8dde922cc93c90af91b628e4" args="()" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcds_1_1lock_1_1_spin_t.html#abc51a4dd8dde922cc93c90af91b628e4">lock</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Lock the spin-lock. Waits infinitely while spin-lock is locked. Debug version: deadlock may be detected. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad41e3ae1d3bf2571b1a58017fe8740b3"></a><!-- doxytag: member="cds::lock::SpinT::unlock" ref="ad41e3ae1d3bf2571b1a58017fe8740b3" args="()" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcds_1_1lock_1_1_spin_t.html#ad41e3ae1d3bf2571b1a58017fe8740b3">unlock</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Unlock the spin-lock. Debug version: deadlock may be detected. <br/></td></tr>
<tr><td colspan="2"><h2><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a57ba62c81a55e53c258b3a0491ff9fd5"></a><!-- doxytag: member="cds::lock::SpinT::m_spin" ref="a57ba62c81a55e53c258b3a0491ff9fd5" args="" -->
volatile <a class="el" href="classcds_1_1lock_1_1_spin_t.html#afba308eb4b0277a4728cddf1edf75071">atomic_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcds_1_1lock_1_1_spin_t.html#a57ba62c81a55e53c258b3a0491ff9fd5">m_spin</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Spin. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a29f10e18210909ae82f3effe1739480a"></a><!-- doxytag: member="cds::lock::SpinT::m_dbgOwnerId" ref="a29f10e18210909ae82f3effe1739480a" args="" -->
OS::ThreadId&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcds_1_1lock_1_1_spin_t.html#a29f10e18210909ae82f3effe1739480a">m_dbgOwnerId</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Owner thread id (only for debug mode) <br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<h3>template&lt;typename ATOMIC, class BACKOFF&gt;<br/>
 class cds::lock::SpinT&lt; ATOMIC, BACKOFF &gt;</h3>

<p>Spin lock. </p>
<p>Simple and light-weight spin-lock critical section It is useful to gain access to small (short-timed) code</p>
<p>Algorithm:</p>
<p>TATAS (test-and-test-and-lock) [1984] L. Rudolph, Z. Segall. Dynamic Decentralized Cache Schemes for MIMD Parallel Processors.</p>
<p>No serialization performed - any of waiting threads may owns the spin-lock. This spin-lock is NOT recursive: the thread owned the lock cannot call <a class="el" href="classcds_1_1lock_1_1_spin_t.html#abc51a4dd8dde922cc93c90af91b628e4" title="Lock the spin-lock. Waits infinitely while spin-lock is locked. Debug version: deadlock may be detect...">lock()</a> method withod deadlock. The method <a class="el" href="classcds_1_1lock_1_1_spin_t.html#ad41e3ae1d3bf2571b1a58017fe8740b3" title="Unlock the spin-lock. Debug version: deadlock may be detected.">unlock()</a> can call any thread</p>
<p>DEBUG version: The spinlock stores owner thead id. Assertion is raised when:</p>
<ul>
<li>double lock attempt encountered by same thread (deadlock)</li>
<li>unlock by another thread</li>
</ul>
<p>If spin-lock is locked the BACKOFF algorithm is called. Predefined <a class="el" href="namespacecds_1_1backoff.html#a195b07b91e318402a3e3a53c4941cc7f" title="Default back-off strategy for lock primitives.">backoff::LockDefault</a> class yields current thread and repeats lock attempts later</p>
<p>Template parameters:</p>
<ul>
<li><code>ATOMIC</code> one of integral atomic type: atomic_t, atomic32_t, atomic32u_t and others</li>
<li><code>BACKOFF</code> backoff strategy. Used when spin lock is locked </li>
</ul>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a53fe77645228546b02cc55e93d4419da"></a><!-- doxytag: member="cds::lock::SpinT::SpinT" ref="a53fe77645228546b02cc55e93d4419da" args="(bool bLocked)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename ATOMIC , class BACKOFF &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcds_1_1lock_1_1_spin_t.html">cds::lock::SpinT</a>&lt; ATOMIC, BACKOFF &gt;::<a class="el" href="classcds_1_1lock_1_1_spin_t.html">SpinT</a> </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"> <em>bLocked</em>&#160;)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Construct spin-lock in specified state. </p>
<p>In debug mode: if <code>bLocked</code> = true then spin-lock is made owned by current thread </p>

</div>
</div>
<a class="anchor" id="a6fd7e177006283461fc815f5949eba8d"></a><!-- doxytag: member="cds::lock::SpinT::SpinT" ref="a6fd7e177006283461fc815f5949eba8d" args="(const SpinT&lt; ATOMIC, BACKOFF &gt; &amp;)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename ATOMIC , class BACKOFF &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcds_1_1lock_1_1_spin_t.html">cds::lock::SpinT</a>&lt; ATOMIC, BACKOFF &gt;::<a class="el" href="classcds_1_1lock_1_1_spin_t.html">SpinT</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classcds_1_1lock_1_1_spin_t.html">SpinT</a>&lt; ATOMIC, BACKOFF &gt; &amp;&#160;</td>
          <td class="paramname">&#160;)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Dummy copy constructor. </p>
<p>In theory, spin-lock cannot be copied. However, it is not practical. Therefore, we provide dummy copy constructor that do no copy in fact. The ctor initializes the spin to free (unlocked) state like default ctor. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>cds/lock/spinlock.h</li>
</ul>
</div>
		<hr/>
		<div align="right">
			<b>cds</b> <b>0.7.0</b> 
			Developed by <i>Maxim Khiszinsky aka khizmax</i> 2007 - 2010
			<br/>
			<i>Autogenerated Sun Dec 5 2010 11:36:31 by Doxygen 1.7.2</i>
		</div>
	</BODY>
</HTML>
